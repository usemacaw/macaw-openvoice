# Macaw OpenVoice — Environment Variables
#
# Copy to `.env` for local development. All values shown are defaults.
# See: macaw/config/settings.py for validation rules.

# ─── Server ───────────────────────────────────────────────────
# API server bind address.
# MACAW_HOST=127.0.0.1

# API server HTTP port (1–65535).
# MACAW_PORT=8000

# Maximum audio upload size in megabytes (1–500).
# MACAW_MAX_FILE_SIZE_MB=25

# Retry-After header value for 503/502 responses (seconds, sent as string).
# MACAW_RETRY_AFTER_S=5

# ─── WebSocket ────────────────────────────────────────────────
# Maximum binary frame size in bytes (min 1024).
# MACAW_MAX_WS_FRAME_SIZE_BYTES=1048576

# Inactivity timeout before closing the WebSocket session (seconds, >0).
# MACAW_WS_INACTIVITY_TIMEOUT_S=60.0

# Heartbeat ping interval (seconds, >0, must be < inactivity timeout).
# MACAW_WS_HEARTBEAT_INTERVAL_S=10.0

# Interval for checking inactivity (seconds, >0).
# MACAW_WS_CHECK_INTERVAL_S=5.0

# ─── TTS ──────────────────────────────────────────────────────
# Timeout for the gRPC Synthesize RPC (seconds, >0).
# MACAW_TTS_GRPC_TIMEOUT_S=60.0

# Timeout for the gRPC ListVoices RPC (seconds, >0).
# MACAW_TTS_LIST_VOICES_TIMEOUT_S=10.0

# ─── Workers ──────────────────────────────────────────────────
# Directory where models are installed (supports ~).
# MACAW_MODELS_DIR=~/.macaw/models

# First gRPC port for worker subprocesses (1024–65535).
# MACAW_WORKER_BASE_PORT=50051

# Hostname for gRPC worker connections. Change for distributed deployments
# (Docker Compose, Kubernetes) where workers run on separate hosts.
# MACAW_WORKER_HOST=localhost

# ─── VAD (Voice Activity Detection) ──────────────────────────
# Sensitivity preset — controls energy + silero thresholds together.
# HIGH = detects whispers (banking, quiet rooms).
# NORMAL = standard conversation (default).
# LOW = noisy environments (call centers, factories).
# MACAW_VAD_SENSITIVITY=normal

# Minimum consecutive speech before emitting SPEECH_START (ms, 50–5000).
# MACAW_VAD_MIN_SPEECH_DURATION_MS=250

# Minimum consecutive silence before emitting SPEECH_END (ms, 50–5000).
# MACAW_VAD_MIN_SILENCE_DURATION_MS=300

# Maximum continuous speech before forced SPEECH_END (ms, 1000–600000).
# Increase for long monologues; decrease for quick turn-taking.
# MACAW_VAD_MAX_SPEECH_DURATION_MS=30000

# ─── Worker Lifecycle ─────────────────────────────────────────
# Max crash count before giving up on a worker (1–100).
# MACAW_WORKER_MAX_CRASHES=3

# Time window for counting crashes (seconds, >0, max 3600).
# MACAW_WORKER_CRASH_WINDOW_S=60.0

# First health probe delay after spawn (seconds, >0, max 60).
# Must be < MACAW_WORKER_HEALTH_PROBE_MAX_DELAY_S.
# MACAW_WORKER_HEALTH_PROBE_INITIAL_DELAY_S=0.5

# Maximum delay between health probe retries (seconds, >0, max 300).
# MACAW_WORKER_HEALTH_PROBE_MAX_DELAY_S=5.0

# Total timeout waiting for a worker to become healthy (seconds, >0, max 600).
# Increase for large models that take long to load (e.g., Whisper large-v3).
# MACAW_WORKER_HEALTH_PROBE_TIMEOUT_S=120.0

# Interval between process-alive checks (seconds, >0, max 60).
# MACAW_WORKER_MONITOR_INTERVAL_S=1.0

# Grace period for gRPC server.stop() before SIGKILL (seconds, >0, max 60).
# MACAW_WORKER_STOP_GRACE_PERIOD_S=5.0

# Number of warmup inference passes at worker startup (0–20).
# Set to 0 to skip warmup (faster startup, slower first request).
# MACAW_WORKER_WARMUP_STEPS=3

# ─── gRPC ─────────────────────────────────────────────────────
# Max gRPC message size for batch (REST) requests in MB (1–500).
# Must be >= MACAW_MAX_FILE_SIZE_MB to accept the largest uploads.
# MACAW_GRPC_MAX_BATCH_MESSAGE_MB=30

# Max gRPC message size for streaming (WebSocket) frames in MB (1–100).
# MACAW_GRPC_MAX_STREAMING_MESSAGE_MB=10

# ─── Scheduler ────────────────────────────────────────────────
# Minimum gRPC timeout for TranscribeFile, regardless of audio length
# (seconds, >0, max 600).
# MACAW_SCHEDULER_MIN_GRPC_TIMEOUT_S=30.0

# Multiplier applied to estimated audio duration to compute gRPC timeout.
# timeout = max(min_grpc_timeout, audio_duration * factor).
# MACAW_SCHEDULER_TIMEOUT_FACTOR=2.0

# Timeout for draining in-flight requests during graceful shutdown
# (seconds, >0, max 120).
# MACAW_SCHEDULER_SHUTDOWN_TIMEOUT_S=10.0

# Time before a BATCH request is promoted to REALTIME priority
# (seconds, >0, max 300). Prevents starvation under load.
# MACAW_SCHEDULER_AGING_THRESHOLD_S=30.0

# Accumulation window for batching consecutive BATCH requests (ms, >0, max 5000).
# Lower = less latency, higher = better throughput.
# MACAW_SCHEDULER_BATCH_ACCUMULATE_MS=50.0

# Maximum number of requests per batch (1–64).
# MACAW_SCHEDULER_BATCH_MAX_SIZE=8

# ─── CLI ──────────────────────────────────────────────────────
# Server URL used by `macaw transcribe` / `macaw translate` commands.
# MACAW_SERVER_URL=http://localhost:8000

# HTTP request timeout for CLI commands (seconds, >0).
# MACAW_HTTP_TIMEOUT_S=120.0

# ─── Logging (read directly by macaw/logging.py, NOT via Settings) ──
# Log format: "console" (human-readable) or "json" (structured).
# MACAW_LOG_FORMAT=console

# Log level: DEBUG, INFO, WARNING, ERROR.
# MACAW_LOG_LEVEL=INFO
